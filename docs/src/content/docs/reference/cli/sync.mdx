---
title: sync
description: Sync secrets to external systems.
---

The `sync` command pushes secrets from zopp to external systems like Kubernetes.

## Commands

| Command | Description |
|---------|-------------|
| `k8s` | Sync to a Kubernetes Secret |

---

## sync k8s

Sync zopp secrets to a Kubernetes Secret.

### Usage

```bash
zopp sync k8s \
  [-w <WORKSPACE>] [-p <PROJECT>] [-e <ENVIRONMENT>] \
  --namespace <NAMESPACE> --secret <SECRET_NAME> \
  [--kubeconfig <PATH>] [--context <CONTEXT>] \
  [--force] [--dry-run]
```

### Options

| Option | Description |
|--------|-------------|
| `-w, --workspace <NAME>` | Workspace name (optional if in `zopp.toml`) |
| `-p, --project <NAME>` | Project name (optional if in `zopp.toml`) |
| `-e, --environment <NAME>` | Environment name (optional if in `zopp.toml`) |
| `--namespace <NS>` | Kubernetes namespace (required) |
| `--secret <NAME>` | Kubernetes Secret name (required) |
| `--kubeconfig <PATH>` | Path to kubeconfig (default: `~/.kube/config`) |
| `--context <CTX>` | Kubernetes context to use |
| `--force` | Force sync even if Secret exists and isn't managed by zopp |
| `--dry-run` | Show what would be synced without applying |

### Example

```bash
# Sync production secrets to Kubernetes
zopp sync k8s -e production --namespace prod --secret api-env

# Output:
# âœ“ Synced 12 secrets to prod/api-env
```

### Dry run

Preview changes before applying:

```bash
zopp sync k8s -e production --namespace prod --secret api-env --dry-run

# Output:
# Would sync 12 secrets to prod/api-env:
#   + API_KEY (new)
#   ~ DATABASE_URL (changed)
#   = REDIS_URL (unchanged)
```

### Force sync

By default, zopp won't overwrite a Secret that wasn't created by zopp. Use `--force` to override:

```bash
zopp sync k8s -e production --namespace prod --secret existing-secret --force
```

---

## What Gets Created

zopp creates a Kubernetes Secret with:

```yaml
apiVersion: v1
kind: Secret
metadata:
  name: api-env
  namespace: prod
  labels:
    app.kubernetes.io/managed-by: zopp
  annotations:
    zopp.dev/workspace: mycompany
    zopp.dev/project: api-backend
    zopp.dev/environment: production
    zopp.dev/synced-at: "2025-01-15T10:30:00Z"
type: Opaque
data:
  API_KEY: base64-encoded-value
  DATABASE_URL: base64-encoded-value
```

The labels and annotations identify the Secret as managed by zopp.

---

## Using with zopp.toml

With defaults configured:

```toml
# zopp.toml
[defaults]
workspace = "mycompany"
project = "api-backend"
environment = "development"
```

```bash
# Uses defaults
zopp sync k8s --namespace dev --secret api-env

# Override for production
zopp sync k8s -e production --namespace prod --secret api-env
```

---

## Multi-Cluster Sync

Use `--context` to sync to different clusters:

```bash
# Sync to staging cluster
zopp sync k8s -e staging --namespace staging --secret api-env --context staging-cluster

# Sync to production cluster
zopp sync k8s -e production --namespace production --secret api-env --context production-cluster
```

---

## Automation

For automated syncing, consider using the [Kubernetes operator](/zopp/guides/kubernetes-operator/) instead. Manual sync is best for:

- One-time migrations
- Debugging
- Environments without the operator

---

## Notes

- Requires `kubectl` access to the target cluster
- The Secret is created/updated atomically
- Existing keys not in zopp are preserved (unless using a fresh sync)
- Use [`diff k8s`](/zopp/reference/cli/diff/) to preview changes before syncing
