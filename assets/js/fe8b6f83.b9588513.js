"use strict";(globalThis.webpackChunkzopp_docs=globalThis.webpackChunkzopp_docs||[]).push([[7945],{7107(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"self-hosting/tls","title":"TLS Configuration","description":"Secure your zopp deployment with TLS.","source":"@site/docs/self-hosting/tls.md","sourceDirName":"self-hosting","slug":"/self-hosting/tls","permalink":"/zopp/self-hosting/tls","draft":false,"unlisted":false,"editUrl":"https://github.com/faiscadev/zopp/tree/main/docs/docs/self-hosting/tls.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"TLS Configuration","description":"Secure your zopp deployment with TLS."},"sidebar":"docs","previous":{"title":"Database Setup","permalink":"/zopp/self-hosting/database"},"next":{"title":"Security","permalink":"/zopp/security/"}}');var s=t(4848),i=t(8453);const l={sidebar_position:4,title:"TLS Configuration",description:"Secure your zopp deployment with TLS."},a="TLS Configuration",c={},o=[{value:"Server TLS",id:"server-tls",level:2},{value:"Client Configuration",id:"client-configuration",level:2},{value:"Generating Certificates",id:"generating-certificates",level:2},{value:"Self-Signed (Development)",id:"self-signed-development",level:3},{value:"Let&#39;s Encrypt (Production)",id:"lets-encrypt-production",level:3},{value:"Mutual TLS (mTLS)",id:"mutual-tls-mtls",level:2},{value:"Docker with TLS",id:"docker-with-tls",level:2},{value:"Kubernetes with TLS",id:"kubernetes-with-tls",level:2},{value:"Next Steps",id:"next-steps",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"tls-configuration",children:"TLS Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"This guide covers configuring TLS for secure communication between zopp clients and the server."}),"\n",(0,s.jsx)(n.h2,{id:"server-tls",children:"Server TLS"}),"\n",(0,s.jsx)(n.p,{children:"Enable TLS on the server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./zopp-server serve \\\n  --tls-cert /path/to/server.crt \\\n  --tls-key /path/to/server.key\n"})}),"\n",(0,s.jsx)(n.p,{children:"Or via environment variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export ZOPP_TLS_CERT=/path/to/server.crt\nexport ZOPP_TLS_KEY=/path/to/server.key\n./zopp-server serve\n"})}),"\n",(0,s.jsx)(n.h2,{id:"client-configuration",children:"Client Configuration"}),"\n",(0,s.jsx)(n.p,{children:"When connecting to a TLS-enabled server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# With CA certificate (for self-signed)\nzopp --server https://zopp.example.com:50051 --tls-ca-cert /path/to/ca.crt workspace list\n\n# Or via environment variable\nexport ZOPP_SERVER=https://zopp.example.com:50051\nexport ZOPP_TLS_CA_CERT=/path/to/ca.crt\nzopp workspace list\n"})}),"\n",(0,s.jsx)(n.h2,{id:"generating-certificates",children:"Generating Certificates"}),"\n",(0,s.jsx)(n.h3,{id:"self-signed-development",children:"Self-Signed (Development)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Generate CA\nopenssl genrsa -out ca.key 4096\nopenssl req -new -x509 -days 365 -key ca.key -out ca.crt \\\n  -subj "/CN=zopp-ca"\n\n# Generate server certificate\nopenssl genrsa -out server.key 4096\nopenssl req -new -key server.key -out server.csr \\\n  -subj "/CN=zopp.example.com"\n\ncat > server.ext << EOF\nauthorityKeyIdentifier=keyid,issuer\nbasicConstraints=CA:FALSE\nkeyUsage = digitalSignature, keyEncipherment\nsubjectAltName = @alt_names\n[alt_names]\nDNS.1 = zopp.example.com\nDNS.2 = localhost\nIP.1 = 127.0.0.1\nEOF\n\nopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key \\\n  -CAcreateserial -out server.crt -days 365 -extfile server.ext\n'})}),"\n",(0,s.jsx)(n.h3,{id:"lets-encrypt-production",children:"Let's Encrypt (Production)"}),"\n",(0,s.jsx)(n.p,{children:"Use certbot or your preferred ACME client:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"certbot certonly --standalone -d zopp.example.com\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then configure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./zopp-server serve \\\n  --tls-cert /etc/letsencrypt/live/zopp.example.com/fullchain.pem \\\n  --tls-key /etc/letsencrypt/live/zopp.example.com/privkey.pem\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mutual-tls-mtls",children:"Mutual TLS (mTLS)"}),"\n",(0,s.jsx)(n.p,{children:"For additional security, require client certificates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./zopp-server serve \\\n  --tls-cert /path/to/server.crt \\\n  --tls-key /path/to/server.key \\\n  --tls-client-ca /path/to/client-ca.crt\n"})}),"\n",(0,s.jsx)(n.p,{children:"Clients then need their own certificates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"zopp --server https://zopp.example.com:50051 \\\n  --tls-ca-cert /path/to/ca.crt \\\n  --tls-cert /path/to/client.crt \\\n  --tls-key /path/to/client.key \\\n  workspace list\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docker-with-tls",children:"Docker with TLS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run -d \\\n  --name zopp-server \\\n  -p 50051:50051 \\\n  -v /path/to/certs:/certs:ro \\\n  ghcr.io/faiscadev/zopp-server:latest \\\n  serve --tls-cert /certs/server.crt --tls-key /certs/server.key\n"})}),"\n",(0,s.jsx)(n.h2,{id:"kubernetes-with-tls",children:"Kubernetes with TLS"}),"\n",(0,s.jsx)(n.p,{children:"Use cert-manager for automatic certificate management:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: zopp-server-tls\nspec:\n  secretName: zopp-server-tls\n  issuerRef:\n    name: letsencrypt-prod\n    kind: ClusterIssuer\n  dnsNames:\n    - zopp.example.com\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then reference in your Helm values:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"server:\n  tls:\n    enabled: true\n    existingSecret: zopp-server-tls\n"})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/self-hosting/server",children:"Server Deployment"})," - Deployment options"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/self-hosting/database",children:"Database Setup"})," - Configure storage"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453(e,n,t){t.d(n,{R:()=>l,x:()=>a});var r=t(6540);const s={},i=r.createContext(s);function l(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);